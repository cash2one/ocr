{"version":3,"sources":["webpack:///./src/entry/technology/ocr-general_enhanced.js","webpack:///./src/entry/common/tech-case.js","webpack:///./src/entry/util/getBase64ByFileReader.js","webpack:///./src/less/technology/ocr-general_enhanced.less","webpack:///./ai_images/error/image-format.png","webpack:///./ai_images/error/no-general-result.png","webpack:///./ai_images/error/timeout.png","webpack:///./ai_images/error/too-large.png","webpack:///./src/view/technology/ocr-general_enhanced.html?d4c8","webpack:///./src/view/technology/ocr-general_enhanced.html"],"names":["formatImg","require","tooLargeImg","noResult","timeoutImg","$window","window","$document","document","$techDemoSelect","$jsonViewer","find","$demoResult","$fileUpload","$scanUrlBtn","$scanPhotoUrl","FILE_TYPE_ERROR","FILE_OVER_SIZE","isScanning","on","scrollTop","playDemo","off","$techFunctionDemoOrigin","$techFunctionDemoResult","addClass","setTimeout","removeClass","setJsonViewer","text","showImage","demoOrigin","html","imgUrl","showLoading","showResult","data","wordsResult","words_result","htmlArr","i","len","length","record","location","template","words","push","join","tableHtml","showError","errno","scan","imageUrl","base64","dfd","Deferred","prop","reject","post","url","then","msg","resolve","promise","showDemoResult","JSONData","JSON","stringify","validateImgFile","validMIMEType","type","file","size","indexOf","isValid","reason","$currentTarget","e","currentTarget","hasClass","siblings","demoUrl","protocol","eq","attr","val","trim","target","imgFile","files","validateResult","firstImg","$techCaseOptionBtn","$target","$techCaseItem","index","imageFile","reader","FileReader","readAsDataURL","onload","result","onerror"],"mappings":";;;;;;;;AAMA;;;;AACA;;;;AAEA;;AACA;;AACA;;;;AAOA;;;;AALA;AACA,IAAMA,YAAY,mBAAAC,CAAQ,EAAR,CAAlB,C,CAdA;;;;;;AAeA,IAAMC,cAAc,mBAAAD,CAAQ,EAAR,CAApB;AACA,IAAME,WAAW,mBAAAF,CAAQ,EAAR,CAAjB;AACA,IAAMG,aAAa,mBAAAH,CAAQ,EAAR,CAAnB;;AAEA;AACA;;AAEA,IAAMI,UAAU,sBAAEC,MAAF,CAAhB;AACA,IAAMC,YAAY,sBAAEC,QAAF,CAAlB;AACA;AACA,IAAMC,kBAAkB,sBAAE,sBAAF,CAAxB;AACA;AACA,IAAMC,cAAc,sBAAE,YAAF,EAAgBC,IAAhB,CAAqB,KAArB,CAApB;AACA;AACA,IAAMC,cAAc,sBAAE,cAAF,CAApB;AACA,IAAMC,cAAc,sBAAE,aAAF,CAApB;AACA;AACA,IAAMC,cAAc,sBAAE,WAAF,CAApB;AACA;AACA,IAAMC,gBAAgB,sBAAE,iBAAF,CAAtB;;AAEA;AACA,IAAMC,kBAAkB,CAAxB;AACA,IAAMC,iBAAiB,CAAvB;;AAEA,IAAIC,aAAa,KAAjB;;AAEAb,QAAQc,EAAR,CACI,aADJ,EAEI,sBACI,YAAM;AACF,QAAIZ,UAAUa,SAAV,MAAyB,GAA7B,EAAkC;AAC9BC;;AAEAhB,gBAAQiB,GAAR,CAAY,OAAZ;AACH;AACJ,CAPL,EAQI,GARJ,CAFJ;;AAcA;AACA,IAAMD,WAAW,SAAXA,QAAW,GAAM;AACnB,QAAME,0BAA0B,sBAAE,8BAAF,CAAhC;AACA,QAAMC,0BAA0B,sBAAE,4BAAF,CAAhC;;AAEAD,4BAAwBE,QAAxB,CAAiC,wBAAjC;;AAEAC,eACI,YAAM;AACFH,gCACKI,WADL,CACiB,wBADjB,EAEKF,QAFL,CAEc,uBAFd;AAGAD,gCACKC,QADL,CACc,uBADd;AAEH,KAPL,EAQI,IARJ;AAUH,CAhBD;;AAkBA;;;;;AAKA,IAAMG,gBAAgB,SAAhBA,aAAgB,GAAe;AAAA,QAAdC,IAAc,uEAAP,EAAO;;AACjCnB,gBAAYmB,IAAZ,CAAiBA,IAAjB;AACH,CAFD;;AAIA;AACA,IAAMC,YAAY,SAAZA,SAAY,SAAU;AACxB,QAAMC,aAAa,sBAAE,cAAF,CAAnB;;AAEAA,eAAWC,IAAX,6CAA0DC,MAA1D;AACH,CAJD;;AAMA,IAAMC,cAAc,SAAdA,WAAc,GAAM;AACtBtB,gBAAYoB,IAAZ,CAAiB,iCAAjB;AACH,CAFD;;AAIA;;;;;AAKA,IAAMG,aAAa,SAAbA,UAAa,OAAQ;AACvB,QAAI,CAACC,IAAL,EAAW;AACPxB,oBAAYoB,IAAZ,CAAiB,EAAjB;;AAEA;AACH;;AAED,QAAMK,cAAcD,KAAKE,YAAL,IAAqB,EAAzC;;AAEA,QAAMC,UAAU,EAAhB;;AAEA,SAAK,IAAIC,IAAI,CAAR,EAAWC,MAAMJ,YAAYK,MAAlC,EAA0CF,IAAIC,GAA9C,EAAmDD,GAAnD,EAAwD;AACpD,YAAMG,SAASN,YAAYG,CAAZ,CAAf;AACA,YAAMI,WAAWD,OAAOC,QAAxB;;AAEA,YAAMC,WAAW,CACb,MADa,gBAEFL,IAAI,CAFF,0BAGFG,OAAOG,KAHL,YAIb,OAJa,CAAjB;;AAOAP,gBAAQQ,IAAR,CAAaF,SAASG,IAAT,CAAc,IAAd,CAAb;AACH;;AAED,QAAMC,YAAYV,QAAQG,MAAR,GAAiB,CAAjB,GACZ,CACE,uBADF,EAEE,yBAFF,EAGE,aAHF,EAIE,cAJF,EAKE,8CALF,EAME,kDANF,EAOE,eAPF,EAQE,cARF,kBASgBH,QAAQS,IAAR,CAAa,IAAb,CAThB,eAUE,UAVF,EAWE,QAXF,EAYAA,IAZA,CAYK,IAZL,CADY,kBAcC7C,QAdD,OAAlB;;AAgBAS,gBAAYoB,IAAZ,CAAiBiB,SAAjB;AACH,CA1CD;;AA4CA;;;;;AAKA,IAAMC,YAAY,SAAZA,SAAY,CAAUC,KAAV,EAAiB;AAC/BhB;AACAP,kBAAc,EAAd;;AAEA,QAAI,CAACuB,KAAL,EAAY;AACRrB,kBAAU9B,SAAV;;AAEA;AACH;;AAED,YAAQmD,KAAR;AACI;AACA,aAAK,GAAL;AACA,aAAKnC,eAAL;AACIc,sBAAU9B,SAAV;;AAEA;AACJ,aAAKiB,cAAL;AACIa,sBAAU5B,WAAV;;AAEA;AACJ;AACA;AACA,aAAK,GAAL;AACA,aAAK,EAAL;AACA;AACI4B,sBAAU9B,SAAV;;AAEA;AAlBR;AAoBH,CA9BD;;AAgCA;;;;;;;AAOA,IAAMoD,OAAO,SAAPA,IAAO,CAAUC,QAAV,EAAoBC,MAApB,EAA4B;AACrC;AACA,QAAMC,MAAM,iBAAEC,QAAF,EAAZ;AACA;;AAEA;AACAtC,iBAAa,IAAb;;AAEAY,cAAUuB,YAAYC,MAAtB;AACApB;AACAN,kBAAc,EAAd;;AAEA;AACAd,gBAAY2C,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;AACA5C,gBAAY4C,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;;AAEA;AACA,QAAIJ,YAAYC,MAAhB,EAAwB;AACpBC,YAAIG,MAAJ;AACH;;AAED,qBAAEC,IAAF,CACI;AACIC,aAAK,SADT;AAEIxB,cAAM;AACF,oBAAQ,kBADN;AAEF,qBAASkB,MAFP;AAGF,yBAAaD;AAHX;AAFV,KADJ,EASEQ,IATF,CAUI,gBAAwB;AAAA,YAAtBV,KAAsB,QAAtBA,KAAsB;AAAA,YAAfW,GAAe,QAAfA,GAAe;AAAA,YAAV1B,IAAU,QAAVA,IAAU;;AACpBlB,qBAAa,KAAb;;AAEAJ,oBAAY2C,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;AACA5C,oBAAY4C,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;;AAEA;AACA,YAAIN,UAAU,CAAd,EAAiB;AACbI,gBAAIQ,OAAJ,CAAY3B,IAAZ;;AAEA;AACH;;AAEDmB,YAAIG,MAAJ,CAAWP,KAAX,EAAkBW,GAAlB;AACH,KAxBL,EAyBI,YAAM;AACF5C,qBAAa,KAAb;;AAEAJ,oBAAY2C,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;AACA5C,oBAAY4C,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;;AAEAF,YAAIG,MAAJ,CAAW,EAAX,EAAe,MAAf;AACH,KAhCL;;AAmCA,WAAOH,IAAIS,OAAJ,EAAP;AACH,CAzDD;;AA2DA;;;;;AAKA,IAAMC,iBAAiB,SAAjBA,cAAiB,WAAY;AAC/B;AACArC,kBAAcsC,WAAWC,KAAKC,SAAL,CAAeF,QAAf,EAAyB,IAAzB,EAA+B,IAA/B,CAAX,GAAkD,EAAhE;AACA;AACA/B,eAAW+B,QAAX;AACH,CALD;;AAOA;;;;;;AAMA,IAAMG,kBAAkB,SAAlBA,eAAkB,OAAQ;AAC5B,QAAMC,gBAAgB,CAClB,YADkB,EACJ,WADI,EACS,WADT,CAAtB;;AAD4B,QAKrBC,IALqB,GAKPC,IALO,CAKrBD,IALqB;AAAA,QAKfE,IALe,GAKPD,IALO,CAKfC,IALe;;;AAO5B,QAAIH,cAAcI,OAAd,CAAsBH,IAAtB,IAA8B,CAAlC,EAAqC;AACjC,eAAO;AACHI,qBAAS,KADN;AAEHC,oBAAQ5D;AAFL,SAAP;AAIH;;AAED,QAAIyD,OAAO,IAAI,IAAJ,GAAW,IAAtB,EAA4B;AACxB,eAAO;AACHE,qBAAS,KADN;AAEHC,oBAAQ3D;AAFL,SAAP;AAIH;;AAED,WAAO;AACH0D,iBAAS;AADN,KAAP;AAGH,CAxBD;;AA0BA;AACA;AACAlE,gBAAgBU,EAAhB,CAAmB,OAAnB,EAA4B,aAAK;AAC7B,QAAM0D,iBAAiB,sBAAEC,EAAEC,aAAJ,CAAvB;;AAEA,QAAIF,eAAeG,QAAf,CAAwB,uBAAxB,KAAoD9D,UAAxD,EAAoE;AAChE;AACH;;AAED2D,mBACKpD,QADL,CACc,uBADd,EAEKwD,QAFL,GAGKtD,WAHL,CAGiB,uBAHjB;;AAKA;AACA,QAAMuD,eAAa5E,OAAOsC,QAAP,CAAgBuC,QAA7B,GAAwCN,eAAelE,IAAf,CAAoB,KAApB,EAA2ByE,EAA3B,CAA8B,CAA9B,EAAiCC,IAAjC,CAAsC,KAAtC,CAA9C;;AAEAjC,SAAK8B,OAAL,EACKrB,IADL,CAEQ,gBAAQ;AACJI,uBAAe7B,IAAf;AACH,KAJT,EAKQc,SALR;AAOH,CAtBD;;AAwBApC,YAAYK,EAAZ,CACI,OADJ,EAEI,YAAM;AACF;AACA,QAAM+D,UAAUnE,cAAcuE,GAAd,GAAoBC,IAApB,EAAhB;;AAEA,QAAI,CAACL,OAAL,EAAc;AACV;AACH;;AAED9B,SAAK8B,OAAL,EACKrB,IADL,CAEQ,gBAAQ;AACJI,uBAAe7B,IAAf;AACH,KAJT,EAKQc,SALR;AAOH,CAjBL;;AAoBA;AACArC,YAAYM,EAAZ,CAAe,QAAf,EAAyB,aAAK;AAC1B,QAAI,CAAC,sBAAE2D,EAAEU,MAAJ,EAAYF,GAAZ,EAAL,EAAwB;AACpB;AACH;;AAED,QAAMG,UAAUX,EAAEU,MAAF,CAASE,KAAT,CAAe,CAAf,CAAhB;;AAEA;AACA,QAAMC,iBAAiBtB,gBAAgBoB,OAAhB,CAAvB;;AAEA,QAAI,CAACE,eAAehB,OAApB,EAA6B;AACzB,gBAAQgB,eAAef,MAAvB;AACI,iBAAK5D,eAAL;AACIkC,0BAAUlC,eAAV;AACA;AACJ,iBAAKC,cAAL;AACIiC,0BAAUjC,cAAV;AACA;AANR;AAQH;;AAED,yCAAsBwE,OAAtB,EACK5B,IADL,CAEQ,kBAAU;AACN;AACAT,aAAK,EAAL,EAASE,MAAT,EACKO,IADL,CAEQ,gBAAQ;AACJI,2BAAe7B,IAAf;AACH,SAJT,EAKQc,SALR;AAOH,KAXT,EAYQA,SAZR;AAcH,CAnCD;;AAqCA;AACA,IAAM0C,gBAActF,OAAOsC,QAAP,CAAgBuC,QAA9B,GAAyC1E,gBAAgB2E,EAAhB,CAAmB,CAAnB,EAAsBzE,IAAtB,CAA2B,KAA3B,EAAkC0E,IAAlC,CAAuC,KAAvC,CAA/C;;AAEAjC,KAAKwC,QAAL,EACK/B,IADL,CAEQ,gBAAQ;AACJI,mBAAe7B,IAAf;AACH,CAJT,EAKQc,SALR,E;;;;;;;;;;ACrXA;;;;;;AAEA,IAAM2C,qBAAqB,sBAAE,uBAAF,CAA3B,C,CAPA;;;;;AASAA,mBAAmB1E,EAAnB,CAAsB,OAAtB,EAA+B,gBAAc;AAAA,QAAZqE,MAAY,QAAZA,MAAY;;AACzC,QAAMM,UAAU,sBAAEN,MAAF,CAAhB;;AAEA,QAAIM,QAAQd,QAAR,CAAiB,kBAAjB,CAAJ,EAA0C;AACtC;AACH;;AAEDc,YACKrE,QADL,CACc,kBADd,EAEKwD,QAFL,GAGKtD,WAHL,CAGiB,kBAHjB;;AAKA,QAAMoE,gBAAgB,sBAAE,iBAAF,EAAqBX,EAArB,CAAwBU,QAAQE,KAAR,EAAxB,CAAtB;;AAEAD,kBACKtE,QADL,CACc,kBADd,EAEKwD,QAFL,GAGKtD,WAHL,CAGiB,kBAHjB;AAIH,CAlBD,E;;;;;;;;;;;;;;kBCKe,UAAUsE,SAAV,EAAqB;AAChC,QAAM1C,MAAM,iBAAEC,QAAF,EAAZ;AACA,QAAM0C,SAAS,IAAIC,UAAJ,EAAf;;AAEAD,WAAOE,aAAP,CAAqBH,SAArB;;AAEAC,WAAOG,MAAP,GAAgB,aAAK;AACjB9C,YAAIQ,OAAJ,CAAYe,EAAEU,MAAF,CAASc,MAArB;AACH,KAFD;;AAIAJ,WAAOK,OAAP,GAAiBhD,IAAIG,MAArB;;AAEA,WAAOH,IAAIS,OAAJ,EAAP;AACH,C;;AArBD;;;;;;;;;;;ACNA,yC;;;;;;;ACAA,wE;;;;;;;ACAA,6E;;;;;;;ACAA,mE;;;;;;;ACAA,qE;;;;;;;ACAA,iBCAA,qBDAA,sD","file":"1495804556/js/technology/ocr-general_enhanced.js","sourcesContent":["/**\r\n * @file ocr-生僻字识别脚本入口\r\n * @author chenweiwei01@baidu.com\r\n *         FranckChen(chenfan02@baidu.com)\r\n */\r\n\r\nimport $ from 'jquery';\r\nimport throttle from 'lodash.throttle';\r\n\r\nimport '../common/tech-case';\r\nimport '../../less/technology/ocr-general_enhanced.less';\r\nimport getBase64ByFileReader from '../util/getBase64ByFileReader';\r\n\r\n/* eslint-disable */\r\nconst formatImg = require('../../../ai_images/error/image-format.png');\r\nconst tooLargeImg = require('../../../ai_images/error/too-large.png');\r\nconst noResult = require('../../../ai_images/error/no-general-result.png');\r\nconst timeoutImg = require('../../../ai_images/error/timeout.png');\r\nimport '!file-loader?name=./../../template/cloud/[name].html!extract-loader!html-loader!view/technology/ocr-general_enhanced.html';\r\n// fixme 很不合理\r\n/* eslint-enable */\r\n\r\nconst $window = $(window);\r\nconst $document = $(document);\r\n// Demo实例图片\r\nconst $techDemoSelect = $('.tech-demo-card-item');\r\n// 结果json展示容器\r\nconst $jsonViewer = $('#demo-json').find('> p');\r\n// 识别结果容器\r\nconst $demoResult = $('#demo-result');\r\nconst $fileUpload = $('#img-upload');\r\n// 检查按键(点击后扫描url中的图片)\r\nconst $scanUrlBtn = $('#scan-url');\r\n// 使用url上传图片\r\nconst $scanPhotoUrl = $('#demo-photo-url');\r\n\r\n// 常量\r\nconst FILE_TYPE_ERROR = 1;\r\nconst FILE_OVER_SIZE = 2;\r\n\r\nlet isScanning = false;\r\n\r\n$window.on(\r\n    'scroll.demo',\r\n    throttle(\r\n        () => {\r\n            if ($document.scrollTop() >= 100) {\r\n                playDemo();\r\n\r\n                $window.off('.demo');\r\n            }\r\n        },\r\n        300\r\n    )\r\n);\r\n\r\n// 功能介绍动画\r\nconst playDemo = () => {\r\n    const $techFunctionDemoOrigin = $('.tech-function-original-card');\r\n    const $techFunctionDemoResult = $('.tech-function-scan-result');\r\n\r\n    $techFunctionDemoOrigin.addClass('tech-function-scanning');\r\n\r\n    setTimeout(\r\n        () => {\r\n            $techFunctionDemoOrigin\r\n                .removeClass('tech-function-scanning')\r\n                .addClass('tech-function-scanned');\r\n            $techFunctionDemoResult\r\n                .addClass('tech-function-scanned');\r\n        },\r\n        3000\r\n    );\r\n};\r\n\r\n/**\r\n * 填充JSON预览内容\r\n *\r\n * @param {string=} text 内容\r\n */\r\nconst setJsonViewer = (text = '') => {\r\n    $jsonViewer.text(text);\r\n};\r\n\r\n// 显示demo图片\r\nconst showImage = imgUrl => {\r\n    const demoOrigin = $('#demo-origin');\r\n\r\n    demoOrigin.html(`<img class=\"tech-demo-origin-img\" src=\"${imgUrl}\">`);\r\n};\r\n\r\nconst showLoading = () => {\r\n    $demoResult.html('<div id=\"result-loading\"></div>');\r\n};\r\n\r\n/**\r\n * 展示识别结果\r\n *\r\n * @param {Object=} data 文字识别接口返回的数据\r\n */\r\nconst showResult = data => {\r\n    if (!data) {\r\n        $demoResult.html('');\r\n\r\n        return;\r\n    }\r\n\r\n    const wordsResult = data.words_result || [];\r\n\r\n    const htmlArr = [];\r\n\r\n    for (let i = 0, len = wordsResult.length; i < len; i++) {\r\n        const record = wordsResult[i];\r\n        const location = record.location;\r\n\r\n        const template = [\r\n            '<tr>',\r\n            `    <td>${i + 1}</td>`,\r\n            `    <td>${record.words}</td>`,\r\n            '</tr>'\r\n        ];\r\n\r\n        htmlArr.push(template.join('\\r'));\r\n    }\r\n\r\n    const tableHtml = htmlArr.length > 0\r\n        ? [\r\n            '<div id=\"json-table\">',\r\n            '<table cellspacing=\"0\">',\r\n            '    <thead>',\r\n            '        <tr>',\r\n            '            <th class=\"result-index\">编号</th>',\r\n            '            <th class=\"result-connent\">识别结果</th>',\r\n            '        </tr>',\r\n            '    </thead>',\r\n            `    <tbody>${htmlArr.join('\\r')}</tbody>`,\r\n            '</table>',\r\n            '</div>'\r\n        ].join('\\r')\r\n        : `<img src=\"${noResult}\">`;\r\n\r\n    $demoResult.html(tableHtml);\r\n};\r\n\r\n/**\r\n * 报告错误结果\r\n *\r\n * @param {number=} errno 错误码\r\n */\r\nconst showError = function (errno) {\r\n    showResult();\r\n    setJsonViewer('');\r\n\r\n    if (!errno) {\r\n        showImage(formatImg);\r\n\r\n        return;\r\n    }\r\n\r\n    switch (errno) {\r\n        // 图片格式错误\r\n        case 104:\r\n        case FILE_TYPE_ERROR:\r\n            showImage(formatImg);\r\n\r\n            return;\r\n        case FILE_OVER_SIZE:\r\n            showImage(tooLargeImg);\r\n\r\n            return;\r\n        // 接口超时\r\n        // 上传失败\r\n        case 107:\r\n        case 28:\r\n        default:\r\n            showImage(formatImg);\r\n\r\n            return;\r\n    }\r\n};\r\n\r\n/**\r\n * 通过提交图片url的方式扫描生僻字\r\n *\r\n * @param {string} imageUrl 图片地址\r\n * @param {string=} base64 图片base64\r\n * @return {Promise}\r\n */\r\nconst scan = function (imageUrl, base64) {\r\n    /* eslint-disable */\r\n    const dfd = $.Deferred();\r\n    /* eslint-enable */\r\n\r\n    // 屏蔽扫面\r\n    isScanning = true;\r\n\r\n    showImage(imageUrl || base64);\r\n    showLoading();\r\n    setJsonViewer('');\r\n\r\n    // 按键置灰\r\n    $scanUrlBtn.prop('disabled', true);\r\n    $fileUpload.prop('disabled', true);\r\n\r\n    // 不能一次提供两个参数\r\n    if (imageUrl && base64) {\r\n        dfd.reject();\r\n    }\r\n\r\n    $.post(\r\n        {\r\n            url: '/aidemo',\r\n            data: {\r\n                'type': 'general_enhanced',\r\n                'image': base64,\r\n                'image_url': imageUrl\r\n            }\r\n        }\r\n    ).then(\r\n        ({errno, msg, data}) => {\r\n            isScanning = false;\r\n\r\n            $scanUrlBtn.prop('disabled', false);\r\n            $fileUpload.prop('disabled', false);\r\n\r\n            // 无误的情况下返回文字识别结果JSON\r\n            if (errno === 0) {\r\n                dfd.resolve(data);\r\n\r\n                return;\r\n            }\r\n\r\n            dfd.reject(errno, msg);\r\n        },\r\n        () => {\r\n            isScanning = false;\r\n\r\n            $scanUrlBtn.prop('disabled', false);\r\n            $fileUpload.prop('disabled', false);\r\n\r\n            dfd.reject(28, '网络错误');\r\n        }\r\n    );\r\n\r\n    return dfd.promise();\r\n};\r\n\r\n/**\r\n * 填充demo展示区，主要是2处内容 -- 核心数据、原始json返回\r\n *\r\n * @param {string=} JSONData JSON数据\r\n */\r\nconst showDemoResult = JSONData => {\r\n    // 格式化JSON\r\n    setJsonViewer(JSONData ? JSON.stringify(JSONData, null, '\\t') : '');\r\n    // 显示识别结果\r\n    showResult(JSONData);\r\n};\r\n\r\n/**\r\n * 校验图片文件是否符合demo要求\r\n *\r\n * @param {File} file 文件\r\n * @return {Object}\r\n */\r\nconst validateImgFile = file => {\r\n    const validMIMEType = [\r\n        'image/jpeg', 'image/png', 'image/bmp'\r\n    ];\r\n\r\n    const {type, size} = file;\r\n\r\n    if (validMIMEType.indexOf(type) < 0) {\r\n        return {\r\n            isValid: false,\r\n            reason: FILE_TYPE_ERROR\r\n        };\r\n    }\r\n\r\n    if (size > 2 * 1024 * 1024) {\r\n        return {\r\n            isValid: false,\r\n            reason: FILE_OVER_SIZE\r\n        };\r\n    }\r\n\r\n    return {\r\n        isValid: true\r\n    };\r\n};\r\n\r\n// fixme\r\n// 实例图片点击点击\r\n$techDemoSelect.on('click', e => {\r\n    const $currentTarget = $(e.currentTarget);\r\n\r\n    if ($currentTarget.hasClass('tech-demo-card-active') || isScanning) {\r\n        return;\r\n    }\r\n\r\n    $currentTarget\r\n        .addClass('tech-demo-card-active')\r\n        .siblings()\r\n        .removeClass('tech-demo-card-active');\r\n\r\n    // TODO demo结构不合理\r\n    const demoUrl = `${window.location.protocol}${$currentTarget.find('img').eq(0).attr('src')}`;\r\n\r\n    scan(demoUrl)\r\n        .then(\r\n            data => {\r\n                showDemoResult(data);\r\n            },\r\n            showError\r\n        );\r\n});\r\n\r\n$scanUrlBtn.on(\r\n    'click',\r\n    () => {\r\n        // 用户输入的url\r\n        const demoUrl = $scanPhotoUrl.val().trim();\r\n\r\n        if (!demoUrl) {\r\n            return;\r\n        }\r\n\r\n        scan(demoUrl)\r\n            .then(\r\n                data => {\r\n                    showDemoResult(data);\r\n                },\r\n                showError\r\n            );\r\n    }\r\n);\r\n\r\n// 用户上传图片时\r\n$fileUpload.on('change', e => {\r\n    if (!$(e.target).val()) {\r\n        return;\r\n    }\r\n\r\n    const imgFile = e.target.files[0];\r\n\r\n    // 上传前在本地校验图片\r\n    const validateResult = validateImgFile(imgFile);\r\n\r\n    if (!validateResult.isValid) {\r\n        switch (validateResult.reason) {\r\n            case FILE_TYPE_ERROR:\r\n                showError(FILE_TYPE_ERROR);\r\n                return;\r\n            case FILE_OVER_SIZE:\r\n                showError(FILE_OVER_SIZE);\r\n                return;\r\n        }\r\n    }\r\n\r\n    getBase64ByFileReader(imgFile)\r\n        .then(\r\n            base64 => {\r\n                // TODO 没设计好,promise没串起来\r\n                scan('', base64)\r\n                    .then(\r\n                        data => {\r\n                            showDemoResult(data);\r\n                        },\r\n                        showError\r\n                    );\r\n            },\r\n            showError\r\n        );\r\n});\r\n\r\n// 页面加载后，分析第一张demo图片\r\nconst firstImg = `${window.location.protocol}${$techDemoSelect.eq(0).find('img').attr('src')}`;\r\n\r\nscan(firstImg)\r\n    .then(\r\n        data => {\r\n            showDemoResult(data);\r\n        },\r\n        showError\r\n    );\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry/technology/ocr-general_enhanced.js","/**\r\n * @file tech-case点击切换\r\n * @author chenweiwei01@baidu.com\r\n */\r\n\r\nimport $ from 'jquery';\r\n\r\nconst $techCaseOptionBtn = $('.tech-case-option-btn');\r\n\r\n$techCaseOptionBtn.on('click', ({target}) => {\r\n    const $target = $(target);\r\n\r\n    if ($target.hasClass('tech-case-active')) {\r\n        return;\r\n    }\r\n\r\n    $target\r\n        .addClass('tech-case-active')\r\n        .siblings()\r\n        .removeClass('tech-case-active');\r\n\r\n    const $techCaseItem = $('.tech-case-item').eq($target.index());\r\n\r\n    $techCaseItem\r\n        .addClass('tech-case-active')\r\n        .siblings()\r\n        .removeClass('tech-case-active');\r\n});\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry/common/tech-case.js","/**\r\n * @file 通过file reader将图片转为base 64编码\r\n * @author Franckchen(chenfan02@baidu.com)\r\n */\r\n\r\n// TODO 替换为标准promise\r\nimport $ from 'jquery';\r\n\r\n/**\r\n * 将图片文件转为base64编码\r\n *\r\n * @param {File} imageFile 图片文件\r\n * @return {Promise}\r\n */\r\nexport default function (imageFile) {\r\n    const dfd = $.Deferred();\r\n    const reader = new FileReader();\r\n\r\n    reader.readAsDataURL(imageFile);\r\n\r\n    reader.onload = e => {\r\n        dfd.resolve(e.target.result);\r\n    };\r\n\r\n    reader.onerror = dfd.reject;\r\n\r\n    return dfd.promise();\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry/util/getBase64ByFileReader.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/less/technology/ocr-general_enhanced.less\n// module id = 23\n// module chunks = 0","module.exports = \"/ai_dist/1495804556/ai_images/error/image-format.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ai_images/error/image-format.png\n// module id = 24\n// module chunks = 0","module.exports = \"/ai_dist/1495804556/ai_images/error/no-general-result.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ai_images/error/no-general-result.png\n// module id = 25\n// module chunks = 0","module.exports = \"/ai_dist/1495804556/ai_images/error/timeout.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ai_images/error/timeout.png\n// module id = 26\n// module chunks = 0","module.exports = \"/ai_dist/1495804556/ai_images/error/too-large.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ai_images/error/too-large.png\n// module id = 27\n// module chunks = 0","module.exports = __webpack_public_path__ + \"./../../template/cloud/ocr-general_enhanced.html\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=./../../template/cloud/[name].html!./~/extract-loader/lib/extractLoader.js!./~/html-loader!./src/view/technology/ocr-general_enhanced.html\n// module id = 28\n// module chunks = 0","null\n\n\n// WEBPACK FOOTER //\n// ./~/template/cloud/[name].html!./~/extract-loader/lib/extractLoader.js!./~/html-loader!./src/view/technology/ocr-general_enhanced.html"],"sourceRoot":""}